{% # theme-check-disable %}
<script src="https://unpkg.com/embla-carousel/embla-carousel.umd.js"></script>
<script src="https://unpkg.com/embla-carousel-progress-bar/embla-carousel-progress-bar.umd.js"></script>
{% # theme-check-enable %}

{% comment %} ----------------------- {% endcomment %}
{% comment %} CUSTOM JAVASCRIPT FILES {% endcomment %}
{% comment %} ----------------------- {% endcomment %}

<script src="{{ 'wm__custom.js' | asset_url }}" defer="defer"></script>

{% # theme-check-disable %}
<script src="https://cdn.jsdelivr.net/npm/motion@latest/dist/motion.js"></script>
{% # theme-check-enable %}

{% comment %} ------------------------ {% endcomment %}
{% comment %} CUSTOM CART CONTROL FILE {% endcomment %}
{% comment %} ------------------------ {% endcomment %}

<script src="{{ 'wm__custom-cart-controls.js' | asset_url }}" defer="defer"></script>

{% comment %} ------------------------ {% endcomment %}
{% comment %} SEGMENT JAVASCRIPT FILES {% endcomment %}
{% comment %} ------------------------ {% endcomment %}

{% comment %} <script src="{{ 'wm__segment-analytics-control.js' | asset_url }}" defer="defer"></script> {% endcomment %}
{% comment %} <script src="{{ 'wm__segment-convertflow-triggers.js' | asset_url }}" defer="defer"></script> {% endcomment %}

{%- if request.page_type == 'product' -%}
  {%- assign product_popup_trigger_metaobject = metaobjects.audience_analytics_trigger.values -%}

  {%- for entry in product_popup_trigger_metaobject -%}
    {%- assign audience_key = entry.audience_key -%}
    {%- assign product_handles = entry.products.value -%}
    {%- assign popup_element_key = entry.popup_element_key -%}
    {%- assign number_to_view_to_trigger = entry.number_to_view_to_trigger -%}

    {%- for item in product_handles -%}
      {%- if item.handle == product.handle -%}
        <script>
          window.popup_trigger = {
            audience_key: "{{ audience_key }}",
            product: "{{ item.handle }}",
            popup_element: "{{ popup_element_key }}",
            number_to_view_to_trigger: {{ number_to_view_to_trigger }}
          };
        </script>
      {%- endif -%}
    {%- endfor -%}
  {%- endfor -%}
{%- endif -%}

<script src="{{ 'wm__popup-triggers.js' | asset_url }}" defer="defer"></script>

{% comment %} Global listener for cart crossing threshold, only activates if cookies set in wm__gwp-picker.liquid active {% endcomment %}
{% comment %} <script src="{{ 'wm__gwp-picker-listener.js' | asset_url }}" defer="defer"></script> {% endcomment %}

{% comment %} A/B testing in PostHog feature flag controls {% endcomment %}
<script src="{{ 'wm__ab-test.js' | asset_url }}" defer="defer"></script>